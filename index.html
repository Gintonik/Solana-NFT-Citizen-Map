<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PERKS NFT Collection</title>
  <style>
    :root {
      --primary: #9945FF;
      --primary-dark: #8134E0;
      --secondary: #14F195;
      --background: #121212;
      --card-bg: #222;
      --text: #FFFFFF;
      --text-secondary: #AAA;
      --border: #333;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: Arial, sans-serif;
      background-color: var(--background);
      color: var(--text);
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    
    /* Header styles */
    header {
      background-color: rgba(25, 25, 25, 0.9);
      padding: 20px 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }
    
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
    }
    
    .logo {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
    }
    
    .nav-links {
      display: flex;
      gap: 20px;
    }
    
    .nav-link {
      color: var(--text);
      text-decoration: none;
      font-weight: bold;
      padding: 8px 12px;
      border-radius: 4px;
      transition: all 0.2s;
    }
    
    .nav-link:hover {
      background-color: rgba(153, 69, 255, 0.1);
    }
    
    .nav-link.active {
      background-color: var(--primary);
      color: white;
    }
    
    /* Main content styles */
    main {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
    }
    
    .page-title {
      margin-bottom: 30px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .button {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .button:hover {
      background-color: var(--primary-dark);
    }
    
    /* Collection Grid styles */
    .stats {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .stats ul {
      display: flex;
      gap: 20px;
      list-style: none;
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .nft-card {
      background-color: var(--card-bg);
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
      border: 1px solid var(--border);
    }
    
    .nft-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(153, 69, 255, 0.2);
    }
    
    .nft-image {
      width: 100%;
      height: 220px;
      object-fit: cover;
      background-color: #2a2a2a;
      display: block;
    }
    
    .nft-info {
      padding: 15px;
    }
    
    .nft-name {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--primary);
    }
    
    .nft-address {
      color: var(--text-secondary);
      font-size: 12px;
      word-break: break-all;
      margin-bottom: 5px;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-secondary);
      font-size: 18px;
    }
    
    /* Footer styles */
    footer {
      background-color: var(--card-bg);
      text-align: center;
      padding: 20px;
      margin-top: 40px;
      color: var(--text-secondary);
    }

    /* Responsive styles */
    @media (max-width: 768px) {
      .grid-container {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
      
      .stats ul {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">PERKS</div>
      <nav class="nav-links">
        <a href="index.html" class="nav-link active">Collection</a>
        <a href="citizen-map" class="nav-link">Citizen Map</a>
      </nav>
    </div>
  </header>
  
  <main>
    <div class="page-title">
      <h1>PERKS NFT Collection</h1>
      <button id="load-collection" class="button">Load Collection</button>
    </div>
    
    <div id="stats" class="stats" style="display: none;">
      <ul>
        <li><strong>Total NFTs:</strong> <span id="nft-count">0</span></li>
        <li><strong>Unique Wallets:</strong> <span id="wallet-count">0</span></li>
      </ul>
    </div>
    
    <div id="loading" class="loading">Click "Load Collection" to view the PERKS NFT collection</div>
    
    <div id="nft-grid" class="grid-container"></div>
  </main>
  
  <footer>
    <p>PERKS NFT Collection Explorer &copy; 2025</p>
  </footer>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const loadButton = document.getElementById('load-collection');
      const stats = document.getElementById('stats');
      const nftCount = document.getElementById('nft-count');
      const walletCount = document.getElementById('wallet-count');
      const loading = document.getElementById('loading');
      const grid = document.getElementById('nft-grid');
      
      loadButton.addEventListener('click', async () => {
        // Show loading state
        loading.textContent = 'Loading NFT collection...';
        loading.style.display = 'block';
        grid.innerHTML = '';
        stats.style.display = 'none';
        
        try {
          // Get NFT owners data
          const response = await fetch('/nft-owners.json');
          const ownersData = await response.json();
          
          // Count stats
          const uniqueWallets = Object.keys(ownersData).length;
          let totalNfts = 0;
          const allNfts = [];
          
          for (const wallet in ownersData) {
            totalNfts += ownersData[wallet].length;
            allNfts.push(...ownersData[wallet]);
          }
          
          // Update stats
          nftCount.textContent = totalNfts;
          walletCount.textContent = uniqueWallets;
          stats.style.display = 'block';
          
          // Display NFTs (first 50 for performance)
          const samplesToShow = allNfts.slice(0, 50);
          
          if (samplesToShow.length === 0) {
            loading.textContent = 'No NFTs found in the collection.';
            return;
          }
          
          loading.style.display = 'none';
          
          samplesToShow.forEach((nftId, index) => {
            const card = document.createElement('div');
            card.className = 'nft-card';
            
            // For demo, we're using a simple naming pattern and the NFT ID for the image URL
            const nftNumber = index + 1; // Simple numbering for demo
            
            card.innerHTML = `
              <img class="nft-image" src="https://gateway.irys.xyz/${nftId}" 
                alt="PERK #${nftNumber}" onerror="this.src='https://via.placeholder.com/220x220?text=NFT+Image'">
              <div class="nft-info">
                <div class="nft-name">PERK #${nftNumber}</div>
                <div class="nft-address">${nftId.substring(0, 10)}...${nftId.substring(nftId.length - 5)}</div>
              </div>
            `;
            
            grid.appendChild(card);
          });
          
          // Add a "Load more" button if there are more NFTs
          if (allNfts.length > samplesToShow.length) {
            const loadMoreContainer = document.createElement('div');
            loadMoreContainer.style.gridColumn = '1 / -1';
            loadMoreContainer.style.textAlign = 'center';
            loadMoreContainer.style.padding = '20px';
            
            const loadMoreButton = document.createElement('button');
            loadMoreButton.className = 'button';
            loadMoreButton.textContent = `Load more (${samplesToShow.length} of ${allNfts.length})`;
            loadMoreButton.addEventListener('click', () => {
              // In a real implementation, you would load the next batch of NFTs
              alert('This would load more NFTs in a real implementation.');
            });
            
            loadMoreContainer.appendChild(loadMoreButton);
            grid.appendChild(loadMoreContainer);
          }
          
        } catch (error) {
          console.error('Error loading NFT data:', error);
          loading.textContent = `Error loading NFT data: ${error.message}`;
        }
      });
    });
  </script>
</body>
</html>